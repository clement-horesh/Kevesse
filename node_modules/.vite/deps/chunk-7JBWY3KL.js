import {
  WCOpenURI,
  handelWCSessionRequest
} from "./chunk-3LEGPGNG.js";
import {
  ConnectingScreen,
  GetStartedScreen,
  ScanScreen,
  isMobile,
  require_lib
} from "./chunk-FYWESOGT.js";
import {
  useConnect,
  useCreateWalletInstance,
  useWalletContext
} from "./chunk-CJ7GN3IJ.js";
import {
  WalletConnect
} from "./chunk-JY3ZYQHU.js";
import {
  require_jsx_runtime
} from "./chunk-3FPM5NHH.js";
import {
  require_react
} from "./chunk-U2VBBHZY.js";
import {
  init_shim
} from "./chunk-6SWLQQ3Q.js";
import {
  __toESM
} from "./chunk-GN3OLCG2.js";

// node_modules/@thirdweb-dev/react/dist/RainbowWallet-192b2f1a.browser.esm.js
init_shim();
var import_react = __toESM(require_react());
var import_jsx_runtime = __toESM(require_jsx_runtime());
var import_react_qr_code = __toESM(require_lib());
var RainbowScan = (_ref) => {
  let {
    onBack,
    onConnected,
    onGetStarted,
    walletConfig,
    hideBackButton
  } = _ref;
  const createInstance = useCreateWalletInstance();
  const [qrCodeUri, setQrCodeUri] = (0, import_react.useState)();
  const {
    setConnectedWallet,
    chainToConnect,
    setConnectionStatus
  } = useWalletContext();
  const scanStarted = (0, import_react.useRef)(false);
  (0, import_react.useEffect)(() => {
    if (scanStarted.current) {
      return;
    }
    scanStarted.current = true;
    const rainbow = createInstance(walletConfig);
    setConnectionStatus("connecting");
    rainbow.connectWithQrCode({
      chainId: chainToConnect == null ? void 0 : chainToConnect.chainId,
      onQrCodeUri(uri) {
        setQrCodeUri(uri);
      },
      onConnected() {
        setConnectedWallet(rainbow);
        onConnected();
      }
    });
  }, [createInstance, setConnectedWallet, chainToConnect, onConnected, walletConfig, setConnectionStatus]);
  return (0, import_jsx_runtime.jsx)(ScanScreen, {
    onBack,
    onGetStarted,
    qrCodeUri,
    walletName: walletConfig.meta.name,
    walletIconURL: walletConfig.meta.iconURL,
    hideBackButton
  });
};
var RainbowConnectUI = (props) => {
  var _a, _b, _c;
  const [screen, setScreen] = (0, import_react.useState)("connecting");
  const {
    walletConfig,
    close
  } = props;
  const connect = useConnect();
  const hideBackButton = props.supportedWallets.length === 1;
  const {
    goBack
  } = props;
  const connectPrompted = (0, import_react.useRef)(false);
  (0, import_react.useEffect)(() => {
    if (connectPrompted.current) {
      return;
    }
    (async () => {
      if (isMobile()) {
        setScreen("open-wc-uri");
      } else {
        setScreen("scanning");
      }
    })();
  }, [walletConfig, close, connect, goBack]);
  if (screen === "connecting") {
    return (0, import_jsx_runtime.jsx)(ConnectingScreen, {
      hideBackButton,
      onBack: props.goBack,
      walletName: walletConfig.meta.name,
      walletIconURL: walletConfig.meta.iconURL,
      supportLink: "https://rainbow.me/"
    });
  }
  if (screen === "open-wc-uri") {
    return (0, import_jsx_runtime.jsx)(WCOpenURI, {
      hideBackButton,
      onBack: props.goBack,
      onConnected: close,
      walletConfig,
      supportLink: "https://rainbow.me/",
      appUriPrefix: {
        ios: "rainbow://",
        android: "https://rnbwapp.com/",
        other: "https://rnbwapp.com/"
      }
    });
  }
  if (screen === "get-started") {
    return (0, import_jsx_runtime.jsx)(GetStartedScreen, {
      walletIconURL: walletConfig.meta.iconURL,
      walletName: walletConfig.meta.name,
      chromeExtensionLink: (_a = walletConfig.meta.urls) == null ? void 0 : _a.chrome,
      googlePlayStoreLink: (_b = walletConfig.meta.urls) == null ? void 0 : _b.android,
      appleStoreLink: (_c = walletConfig.meta.urls) == null ? void 0 : _c.ios,
      onBack: () => {
        setScreen("scanning");
      }
    });
  }
  if (screen === "scanning") {
    return (0, import_jsx_runtime.jsx)(RainbowScan, {
      onBack: props.goBack,
      onConnected: close,
      onGetStarted: () => {
        setScreen("get-started");
      },
      hideBackButton,
      walletConfig
    });
  }
  return null;
};
var rainbowWalletUris = {
  ios: "rainbow://",
  android: "https://rnbwapp.com/",
  other: "https://rnbwapp.com/"
};
var rainbowWallet = (options) => {
  return {
    id: "rainbow",
    meta: {
      name: "Rainbow Wallet",
      iconURL: "ipfs://QmSZn47p4DVVBfzvg9BAX2EqwnPxkT1YAE7rUnrtd9CybQ/rainbow-logo.png",
      urls: {
        android: "https://rnbwapp.com/e/Va41HWS6Oxb",
        ios: "https://rnbwapp.com/e/OeMdmkJ6Oxb"
      }
    },
    create: (walletOptions) => {
      const wallet = new WalletConnect({
        ...walletOptions,
        walletId: "rainbow",
        projectId: options == null ? void 0 : options.projectId,
        qrcode: false
      });
      handelWCSessionRequest(wallet, rainbowWalletUris);
      return wallet;
    },
    connectUI: RainbowConnectUI,
    isInstalled() {
      return false;
    }
  };
};

export {
  rainbowWallet
};
//# sourceMappingURL=chunk-7JBWY3KL.js.map
